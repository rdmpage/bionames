{
   "_id": "_design/html",
   "_rev": "73-077495539215d6c12471fd1ed8e37b71",
   "language": "javascript",
   "shows": {
       "object": "function(doc,req) {  var html = ''; var types = ['article','book','chapter','generic','journal']; var type = types.indexOf(doc.type); if (type != -1) { html += '<!DOCTYPE html>'; html += '<html>'; html += '<head>'; html += '  <base href=\"http://bionames.org/\" /><!--[if IE]></base><![endif]-->'; html += '  <title>' + doc.title + '</title>'; html += '  <link href=\\'images/favicon.png\\' rel=\\'icon\\' type=\\'image/png\\'>'; html += '  '; html += '  <link href=\\'http://fonts.googleapis.com/css?family=Montserrat:400,700\\' rel=\\'stylesheet\\' type=\\'text/css\\'>'; html += ''; html += '  <link href=\"vendor/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" media=\"screen\">'; html += ''; html += '  <!-- responsive -->'; html += '  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">'; html += '  <link href=\"vendor/bootstrap/css/bootstrap-responsive.css\" rel=\"stylesheet\">  '; html += ''; html += '  <link href=\"stylesheets/style.css\" rel=\"stylesheet\" media=\"screen\">'; html += '  '; html += '  <script src=\"http://code.jquery.com/jquery-1.9.1.min.js\"></script>'; html += '  '; html += '  <script src=\"vendor/bootstrap/js/bootstrap.min.js\"></script>'; html += '  <script src=\"js/lib/d3.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"js/lib/crossfilter.1.2.0.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += ''; html += '  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->'; html += '  <!--[if lt IE 9]>'; html += '    <script src=\"http://html5shim.googlecode.com/svn/trunk/html5.js\"></script>'; html += '  <![endif]-->'; html += ''; html += '  <script src=\"js/openurl.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"js/display.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"js/snippet.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"js/filter_widgets.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += ''; html += '  <!-- UserVoice JavaScript SDK (only needed once on a page) -->'; html += '  <script>(function(){var uv=document.createElement(\\'script\\');uv.type=\\'text/javascript\\';uv.async=true;uv.src=\\'//widget.uservoice.com/c3F4NBjddqKXajc7buiKtQ.js\\';var s=document.getElementsByTagName(\\'script\\')[0];s.parentNode.insertBefore(uv,s)})()</script>'; html += ''; html += '  <!-- A tab to launch the Classic Widget -->'; html += '  <script>'; html += '  UserVoice = window.UserVoice || [];'; html += '  UserVoice.push([\\'showTab\\', \\'classic_widget\\', {'; html += '    mode: \\'feedback\\','; html += '    primary_color: \\'#cc6d00\\','; html += '    link_color: \\'#007dbf\\','; html += '    forum_id: 208867,'; html += '    tab_label: \\'Feedback\\','; html += '    tab_color: \\'#cc6d00\\','; html += '    tab_position: \\'middle-right\\','; html += '    tab_inverted: false'; html += '  }]);'; html += '  </script>  '; html += '  '; html += '  '; html += '  <!-- documentcloud -->'; html += '  <!--[if (!IE)|(gte IE 8)]><!-->'; html += '  <link href=\"public/assets/viewer-datauri.css\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" />'; html += '  <link href=\"public/assets/plain-datauri.css\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" />'; html += '  <!--<![endif]-->'; html += '  <!--[if lte IE 7]>'; html += '  <link href=\"public/assets/viewer.css\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" />'; html += '  <link href=\"public/assets/plain.css\" media=\"screen\" rel=\"stylesheet\" type=\"text/css\" />'; html += '  <![endif]-->'; html += '  '; html += '  <script src=\"public/assets/viewer.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"public/assets/templates.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  '; html += '  <script> '; html += '    var docUrl = \\'\\'; '; html += '  </script>  '; html += '  '; html += '  <!-- altmetric.com -->'; html += '  <!-- <script type=\\'text/javascript\\' src=\\'https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js\\'></script> -->'; html += '  '; html += '  '; html += '</head>'; html += '<body onload=\"$(window).resize()\" class=\"publication\">'; html += '  <script type=\"text/javascript\">'; html += '    var _gaq = _gaq || [];'; html += '    _gaq.push([\\'_setAccount\\', \\'UA-41311788-1\\']);'; html += '    _gaq.push([\\'_trackPageview\\']);'; html += '  '; html += '    (function() {'; html += '    var ga = document.createElement(\\'script\\'); ga.type = \\'text/javascript\\'; ga.async = true;'; html += '    ga.src = (\\'https:\\' == document.location.protocol ? \\'https://ssl\\' : \\'http://www\\') + \\'.google-analytics.com/ga.js\\';'; html += '    var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(ga, s);'; html += '    })();'; html += '  </script>  '; html += ''; html += '  <div class=\"navbar navbar-fixed-top\">'; html += '    <div class=\"navbar-inner\">'; html += '      <div class=\"container-fluid\">'; html += '         <a class=\"brand\" href=\"/\">BioNames</a>'; html += '         <ul class=\"nav\">'; html += '          <li><form class=\"navbar-search pull-left\" method=\"get\" action=\"/\">'; html += '          <input type=\"text\" id=\\'q\\' name=\\'q\\' data-provide=\"typeahead\" class=\"search-query\" placeholder=\"Search\" autocomplete=\"off\" value=\"\">'; html += '          </form> '; html += '          </li>'; html += '          <li><a href=\"dashboard\">Dashboard</a></li>'; html += '          </ul>'; html += '        </div>'; html += '    </div>'; html += '  </div>'; html += '';         html += '<div itemscope ';      switch (doc.type)   {     case 'article':       html += 'itemtype=\"http://schema.org/ScholarlyArticle\"';              break;      case 'book':       html += 'itemtype=\"http://schema.org/Book\"';       break;            default:       html += 'itemtype=\"http://schema.org/Article\"';       break;   }      var bibo_type = '';      switch (doc.type)   {     case 'article':       bibo_type = \"Article\";       break;      case 'book':       bibo_type = \"Book\";       break;      case 'chapter':       bibo_type = \"Chapter\";       break;            default:       bibo_type = \"Document\";       break;   }      html += 'class=\"container-fluid\" style=\"margin-top: 60px;\">';  html += '    <div class=\"row-fluid\">'; html += '      <div class=\"main-content span8\">'; html += '      '; html += '        <ul id=\"publication-tabs\" class=\"nav nav-tabs\">'; html += '          <li class=\"active\"><a href=\"#view-tab\" data-toggle=\"tab\">View</a></li>'; html += '          <li><a href=\"#details-tab\" data-toggle=\"tab\">Details</a></li>'; html += '          <li><a href=\"#data-tab\" data-toggle=\"tab\">Names <span id=\"data-badge\" class=\"badge badge-info\"></span></a></li>'; html += '          <li><a href=\"#grid-tab\" data-toggle=\"tab\">Grid</span></a></li>'; html += '        </ul>'; html += '      '; html += '        <div class=\"tab-content\">          '; html += ''; html += '          <div class=\"tab-pane active\" id=\"view-tab\">'; html += '          <div id=\"document-viewer-span\">'; html += '            <div id=\"doc\">';  if (doc.thumbnail) {   html += '<div style=\"text-align:center;\">';   html += '<div class=\"alert\">';   html += '<strong>Limited access!</strong> You may need a subscription to access this item.';   html += '</div>';   html += '<img style=\"border:1px solid rgb(128,128,128);padding:10px;background-color:white;\" src=\"' + doc.thumbnail + '\" width=\"400\" />';   html += '</div>'; } else {   html += '<div style=\"text-align:center;\">';   html += '<div class=\"alert\">';   html += 'Unable to display this item.';   html += '</div>';   html += '</div>'; }              html += '            </div>'; html += '          </div>  '; html += '          </div>'; html += '          '; html += '          <div class=\"tab-pane\" id=\"details-tab\">'; html += '          <div id=\"metadata\" style=\"padding:20px;\">'; html += '            <div id=\"publication_data\">'; html += '              <table class=\"table\">'; html += '                <thead></thead>'; html += '                <tbody>';  if (doc.title) {   html += '<tr><td class=\"muted\">Title</td><td>';   html += '<span itemprop=\"name\">';   html += doc.title;   html += '</span>';     html += '</td></tr>'; }  if (doc.thumbnail) {   html += '<tr><td class=\"muted\">Thumbnail</td><td><img class=\"img-polaroid\" src=\"' + doc.thumbnail + '\" width=\"100\" /></td</tr>';      html += '<meta itemprop=\"thumbnailUrl\" content=\"' + 'api/id/' + doc._id + '/thumbnail/image\" />'; }                      if (doc.author) {   html += '<tr><td class=\"muted\">Author(s)</td><td>';   for (var j in doc.author)   {     html += '<span itemprop=\"author\" itemscope itemtype=\"http://schema.org/Person\">';     html += '<a href=\"authors/' + doc.author[j].name + '\" itemprop=\"url\">';     html += '<span itemprop=\"name\">';     html += '<i class=\"icon-user\"></i>';     html += doc.author[j].name;     html += '</span>';     html += '</span>';     html += ' ';     html += '</a>';     html += '  ';   }   html += '</td></tr>'; }  if (doc.journal) {   if (doc.journal.name)   {     html += '<tr><td class=\"muted\">Journal</td><td>' + doc.journal.name + '</td></tr>';          var issn = '';     var oclc = '';     if (doc.journal.identifier)     {       for (var j in doc.journal.identifier)       {         if (doc.journal.identifier[j])          {           switch (doc.journal.identifier[j].type)           {             case 'issn':               html += '<tr><td class=\"muted\">ISSN<td><a href=\"issn/' + doc.journal.identifier[j].id + '\" rel=\"tooltip\" title=\"The International Standard Serial Number (ISSN) ' + doc.journal.identifier[j].id + ' is a unique identifier for this journal\" class=\"tip\">' + doc.journal.identifier[j].id + '</a></td></tr>';               break;              case 'oclc':               html += '<tr><td class=\"muted\">OCLC</td><td><a href=\"oclc/' + doc.journal.identifier[j].id + '\" rel=\"tooltip\" title=\"Online Computer Library Center, Inc. (OCLC) number ' + doc.journal.identifier[j].id + '\" class=\"tip\">' + doc.journal.identifier[j].id + '</a></td></tr>';               break;                            default:               break;           }         }       }     }   }      if (doc.journal.volume)   {     html += '<tr><td class=\"muted\">Volume</td><td>' + doc.journal.volume + '</td></tr>';   }   if (doc.journal.issue)   {     html += '<tr><td class=\"muted\">Issue</td><td>' + doc.journal.issue + '</td></tr>';   }   if (doc.journal.pages)   {     html += '<tr><td class=\"muted\">Pages</td><td>' + doc.journal.pages + '</td></tr>';   } }  var biostor = 0; var doi = '';  if (doc.identifier) {   for (var j in doc.identifier)   {     switch (doc.identifier[j].type)     {       case \"ark\":         html += '<tr><td class=\"muted\">ARK</td><td><a href=\"http://gallica.bnf.fr/ark:/' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'gallica\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"The Archival Resource Key (ARK) ark:/' + doc.identifier[j].id + ' is a persistent identifier for this publication\" class=\"tip\"><i class=\"icon-share\"></i> ark:/' + doc.identifier[j].id + '</a></td></tr>';         break;        case \"biostor\":         biostor = doc.identifier[j].id;         html += '<tr><td class=\"muted\">BioStor</td><td><a href=\"http://biostor.org/reference/' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'biostor\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"BioStor reference ' + doc.identifier[j].id + '\" class=\"tip\"><i class=\"icon-share\"></i> ' + doc.identifier[j].id + '</a></td></tr>';         break;        case \"cinii\":         html += '<tr><td class=\"muted\">CiNii</td><td><a href=\"http://ci.nii.ac.jp/naid/' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'cinii\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"National Institute of Informatics Article ID (NAID)' + doc.identifier[j].id + '\" class=\"tip\"><i class=\"icon-share\"></i> ' + doc.identifier[j].id + '</a></td></tr>';         break;                case \"doi\":         doi = doc.identifier[j].id;                  html += '<tr><td class=\"muted\">DOI</td><td>';                 html += '<a href=\"http://dx.doi.org/' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'doi\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"The Digital Object Identifier (DOI) ' + doc.identifier[j].id + ' is the persistent identifier for this publication\" class=\"tip\">';         html += '<i class=\"icon-share\"></i>';         html += '<span vocab=\"http://purl.org/ontology/bibo/\" typeof=\"' + bibo_type + '\">';         html += '<span property=\"doi\">';         html += doc.identifier[j].id;         html += '</span>';         html += '</span>';                  html += doc.identifier[j].id;         html += '</a>';                  html += '</td></tr>';         break;        case \"googleBooks\":         html += '<tr><td class=\"muted\">Google Books</td><td>' + '<a href=\"http://books.google.co.uk/books?id=' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'googlebooks\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"This publication is in Google Books\" class=\"tip\">' + doc.identifier[j].id + '</a>' + '</td></tr>';         break;        case \"handle\":         html += '<tr><td class=\"muted\">Handle</td><td><a href=\"http://hdl.handle.net/' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'handle\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"The Handle ' + doc.identifier[j].id + ' is a persistent identifier for this publication\" class=\"tip\"><i class=\"icon-share\"></i> ' + doc.identifier[j].id + '</a></td></tr>';         break;        case \"isbn\":         html += '<tr><td class=\"muted\">ISBN</td><td>';         html += '<span rel=\"tooltip\" title=\"ISBN\" class=\"tip\">';         html += '<span itemprop=\"isbn\">';         html += doc.identifier[j].id;         html += '</span>';         html += '</span>';         html += '</td></tr>';         break;        case \"jstor\":         html += '<tr><td class=\"muted\">JSTOR</td><td><a href=\"http://www.jstor.org/stable/' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'jstor\\', \\'' + doc.identifier[j].id + '\\', 0]);\" target=\"_new\" rel=\"tooltip\" title=\"Available from JSTOR\" class=\"tip\"><i class=\"icon-share\"></i> ' + doc.identifier[j].id + '</a></td></tr>';         break;        case \"oclc\":         html += '<tr><td class=\"muted\">OCLC</td><td><a href=\"http://www.worldcat.org/oclc/' + doc.identifier[j].id + '\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'oclc\\', \\'' + doc.identifier[j].id + '\\', 0]);\" target=\"_new\" rel=\"tooltip\" title=\"Online Computer Library Center, Inc. (OCLC) number ' + doc.identifier[j].id + '\" class=\"tip\"><i class=\"icon-share\"></i> ' + doc.identifier[j].id + '</a></td></tr>';         break;        case \"pmc\":         html += '<tr><td class=\"muted\">PMC</td><td><a href=\"http://www.ncbi.nlm.nih.gov/pmc/PMC' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'pmc\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"PubMed Central PMC' + doc.identifier[j].id + '\" class=\"tip\"><i class=\"icon-share\"></i> ' + 'PMC' + doc.identifier[j].id + '</a></td></tr>';         break;        case \"pmid\":         html += '<tr><td class=\"muted\">PMID</td><td><a href=\"http://www.ncbi.nlm.nih.gov/pubmed/' + doc.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'pmid\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"PubMed ID (PMID) ' + doc.identifier[j].id + '\" class=\"tip\"><i class=\"icon-share\"></i> ' + doc.identifier[j].id + '</a></td></tr>';         break;                default:         break;     }   }   }  /* Book */ if (doc.book) {   if (doc.book.title && (doc.type == 'chapter'))   {     html += '<tr><td class=\"muted\">Book title</td><td>' + doc.book.title + '</td></tr>';   }   if (doc.book.pages)   {     html += '<tr><td class=\"muted\">Pages</td><td>' + doc.book.pages + '</td></tr>';   }   if (doc.book.identifier)   {     for (var j in doc.book.identifier)     {       switch (doc.book.identifier[j].type)       {           case \"googleBooks\":           html += '<tr><td class=\"muted\">Google Books</td><td>' + '<a href=\"http://books.google.co.uk/books?id=' + doc.book.identifier[j].id + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'googlebooks\\', \\'' + doc.identifier[j].id + '\\', 0]);\" rel=\"tooltip\" title=\"This publication is in Google Books\" class=\"tip\">' + doc.book.identifier[j].id + '</a>' + '</td></tr>';           break;          case \"isbn\":           html += '<tr><td class=\"muted\">ISBN</td><td>';           html += '<span rel=\"tooltip\" title=\"ISBN\" class=\"tip\">';           html += '<span itemprop=\"isbn\">';           html += doc.book.identifier[j].id;           html += '</span>';           html += '</span>';           html += '</td></tr>';           break;                    default:           break;       }     }     } }  /* Item-level links */ if (doc.link) {   for (var j in doc.link)   {     switch (doc.link[j].anchor)     {       case \"PDF\":         html += '<tr><td class=\"muted\">PDF</td><td><a href=\"' + doc.link[j].url + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'pdf\\', \\'' + doc.link[j].url + '\\', 0]);\"><i class=\"icon-share\"></i> ' +  doc.link[j].url + '</a></td></tr>';         break;        case \"LINK\":         html += '<tr><td class=\"muted\">URL</td><td><a href=\"' + doc.link[j].url + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'url\\', \\'' + doc.link[j].url + '\\', 0]);\"><i class=\"icon-share\"></i> ' + doc.link[j].url + '</a></td></tr>';         break;                default:         break;     }   } }  if (doc.file) {   html += '<tr><td class=\"muted\">SHA1</td><td>' +  doc.file.sha1 + '</td></tr>'; }  /* Date */ if (doc.year) {   html += '<tr><td class=\"muted\">Year</td><td>';   html += '<span itemprop=\"datePublished\">';   html += doc.year;   html += '</span>';   html += '</td></tr>'; }  if (doc.publisher) {   html += '<tr><td class=\"muted\">Publisher</td><td>';   html += '<span itemprop=\"publisher\">';   html += doc.publisher;   html += '</span>';     html += '</td></tr>'; }   html += '                </tbody>'; html += '              </table>'; html += '            </div>'; html += '          </div>  '; html += '          </div>'; html += '          '; html += '          '; html += '          <div class=\"tab-pane\" id=\"data-tab\">'; html += '          <div id=\"names\">...</div>'; html += '          </div>'; html += ''; html += '          <div class=\"tab-pane\" id=\"grid-tab\">'; html += '          <div id=\"grid\" style=\"overflow:auto;\">...</div>'; html += '          </div>'; html += ''; html += '        </div>'; html += '      </div>'; html += '      '; html += '      <div class=\"sidebar span4\">'; html += '        <div class=\"sidebar-header\">'; html += '          <h1 id=\"title\">' + doc.title + '</h1>'; html += '        </div>'; html += '        <div id=\"metadata\" class=\"sidebar-metadata\">'; html += '          <div id=\"stats\" class=\"stats\"></div>'; html += '          <div id=\"authors\" class=\"sidebar-section\">';  if (doc.author) {   html += '<h3>Authors</h3>';   html += '<ul>';   for (var j in doc.author)   {     html += '<li>';     html += '<a href=\"authors/' + doc.author[j].name + '\"><i class=\"icon-user\"></i>';     html += doc.author[j].name;     html += '</a>';     html += '</li>';   }   html += '</ul>'; }  html += '          </div>'; html += '          <div id=\"map\" class=\"sidebar-section\">';  /* Map if we have points */ if (doc.geometry) {   html += '<h3>Map</h3>';   html += '<p class=\"muted\">Localities in publication.</p>';   html += '<object id=\"mapsvg\" type=\"image/svg+xml\" width=\"360\" height=\"180\" data=\"map.php?coordinates=' + encodeURIComponent(JSON.stringify(doc.geometry.coordinates)) + '\"></object>'; }  html += '          </div>  '; html += '        </div>'; html += '        <div class=\"sidebar-metadata\">'; html += '          <div id=\"view_publisher\">';  if (biostor != 0) {   html += '<a href=\"http://biostor.org/reference/' + biostor + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'biostor\\', \\'' + biostor + '\\', 0]);\" class=\"btn btn-block btn-primary\"><i class=\"icon-share icon-white\"></i>View on BioStor</a>'; } if (doi != '') {   html += '<a href=\"http://dx.doi.org/' + doi + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'doi\\', \\'' + doi + '\\', 0]);\" class=\"btn btn-block btn-primary\"><i class=\"icon-share icon-white\"></i>View on publisher\\'s website</a>'; }                      html += '          </div>'; html += '          <div id=\"view_pdf\"></div>'; html += '          <div id=\"view_deepdyve\" style=\"display:none;\">';  {   html += '<a id=\"deep_dyve\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'deepdyve\\', \\'0\\', 0]);\" class=\"btn btn-info btn-block\"><i class=\"icon-share icon-white\"></i>View on DeepDyve</a>'; }  html += '          </div>'; html += '          <div id=\"plugins\" class=\"sidebar-section\">'; html += '          </div>  '; html += '        </div>'; html += '        '; html += '        <div>'; html += '          <div id=\"disqus_thread\"></div>'; html += '            <script type=\"text/javascript\">'; html += '              /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */'; html += '              var disqus_shortname = \\'bionames\\'; /* required: replace example with your forum shortname */'; html += '            '; html += '              /* * * DON\\'T EDIT BELOW THIS LINE * * */'; html += '              (function() {'; html += '                var dsq = document.createElement(\\'script\\'); dsq.type = \\'text/javascript\\'; dsq.async = true;'; html += '                dsq.src = \\'//\\' + disqus_shortname + \\'.disqus.com/embed.js\\';'; html += '                (document.getElementsByTagName(\\'head\\')[0] || document.getElementsByTagName(\\'body\\')[0]).appendChild(dsq);'; html += '              })();'; html += '            </script>'; html += '            <noscript>Please enable JavaScript to view the <a href=\"http://disqus.com/?ref_noscript\">comments powered by Disqus.</a></noscript>'; html += '            <a href=\"http://disqus.com\" class=\"dsq-brlink\">comments powered by <span class=\"logo-disqus\">Disqus</span></a>'; html += '            </div>'; html += '      </div>'; html += '    </div>'; html += '  </div>'; html += '  '; html += '<script>'; html += '  /* tooltips */'; html += '  $(\\'.tip\\').tooltip();'; html += '  '; html += '  var windowWidth = $(window).width();'; html += '  var windowHeight =$(window).height();  '; html += '  '; html += '  function display_document() {'; html += '    if (docUrl != \\'\\')'; html += '    {'; html += '      DV.load(docUrl, {'; html += '        container: \\'#doc\\','; html += '        width:$(\\'#document-viewer-span\\').width(),'; html += '        height:$(window).height() -  $(\\'#document-viewer-span\\').offset().top,'; html += '        sidebar: false'; html += '      });  '; html += '    }'; html += '  }  '; html += '  '; html += '  function display_publication_names (id)'; html += '  {'; html += '    $.getJSON(\"http://bionames.org/bionames-api/publication/\" + id + \"/names?callback=?\",'; html += '      function(data){'; html += '        if (data.status == 200)'; html += '        {'; html += '          add_metadata_stat(\\'Names\\', data.names.length);'; html += '          '; html += '          /* Set badge on this tab so people know it has something to see */'; html += '          $(\\'#data-badge\\').text(data.names.length);'; html += '          /* Need this to force tab update */'; html += '          $(\\'#publication-tabs li:eq(2) a\\').show();'; html += '                  '; html += '          var html = \\'\\';'; html += '          '; html += '          html += \\'<h4>Names published</h4>\\';'; html += '          '; html += '          html += \\'<table class=\"table\">\\';'; html += '          for (var i in data.names) {'; html += '            html += \\'<tr>\\';'; html += '            html += \\'<td>\\';'; html += '            html += \\'<a href=\"names/\\' + data.names[i].cluster + \\'\">\\';'; html += '            html += data.names[i].nameComplete;'; html += '            '; html += '            if (data.names[i].taxonAuthor) {'; html += '              html += data.names[i].taxonAuthor;'; html += '            }'; html += '            '; html += '            html += \\'</a>\\';'; html += '            html += \\'</td>\\';'; html += '            html += \\'<td>\\';'; html += '            '; html += '            if (data.names[i].id) {'; html += '              if (data.names[i].id.match(/urn:lsid:organismnames.com:name:/)) {'; html += '                var lsid = '; html += '                html += \\'<a href=\"http://www.organismnames.com/details.htm?lsid=\\' + data.names[i].id.replace(\\'urn:lsid:organismnames.com:name:\\', \\'\\') + \\'\" target=\"_new\" rel=\"tooltip\" title=\"Life Science Identifier (LSID) for this taxon name\" class=\"tip\"><i class=\"icon-share\"></i> \\' + data.names[i].id + \\'</a>\\';'; html += '              }'; html += '            }'; html += '            html += \\'</td>\\';'; html += '          }'; html += '          html += \\'</table>\\';'; html += '          '; html += '          $(\\'#names\\').html(html);'; html += '          '; html += '          $(\\'.tip\\').tooltip();'; html += '        }'; html += '      });'; html += '  }'; html += '  '; html += '  '; html += '  function deep_dyve(title) {'; html += '    $.getJSON(\"http://www.deepdyve.com/openurl?type=jsonp&affiliateId=BioNames&atitle=\" + encodeURIComponent(title) + \"&callback=?\",'; html += '      function(data){'; html += '        if (data.articleFound) {'; html += '          if (data.articleFound == \\'true\\') {'; html += '            $(\\'#deep_dyve\\').attr(\\'href\\', data.articleLink);'; html += '            $(\\'#view_deepdyve\\').show();'; html += '          }'; html += '        }'; html += '      });  '; html += '  }'; html += '  '; html += ''; html += '  /* http://stackoverflow.com/questions/6762564/setting-div-width-according-to-the-screen-size-of-user */'; html += '  $(window).resize(function() { '; html += '    /* Only resize document window if we have a document cloud viewer */'; html += '    if (docUrl) {'; html += '      var windowWidth = $(\\'#view-tab\\').width();'; html += '      var windowHeight =$(window).height() -  $(\\'#document-viewer-span\\').offset().top;'; html += '      $(\\'#doc\\').css({\\'height\\':windowHeight, \\'width\\':windowWidth });'; html += '    }'; html += '  });  '; html += ''; html += '  /* typeahead for search box */'; html += '  $(\"#q\").typeahead({'; html += '    source: function (query, process) {'; html += '    $.getJSON(\\'http://bionames.org/bionames-api/name/\\' + query + \\'/suggestions?callback=?\\', '; html += '    function (data) {'; html += '      var suggestions = data.suggestions;'; html += '      process(suggestions)'; html += '    })'; html += '    }'; html += '  });'; html += '  '; html += '</script>'; html += ''; html += '<script>';    html += 'var id = \"' + doc._id + '\";';  html += '  var windowWidth = $(window).width();'; html += '  var windowHeight =$(window).height();'; html += '  '; html += '  function add_metadata_stat(title,value) {'; html += '    $(display_stat(title,value)).appendTo($(\\'#stats\\'));    '; html += '  }'; html += '  '; html += '  display_publication_names(id);';    if (doc.title)   {     html += 'deep_dyve(\\'' + doc.title + '\\');';   }      var docUrl = '';      if (doc.identifier)   {     for (var j in doc.identifier)     {       switch (doc.identifier[j].type)       {         case \"ark\":           var ark = doc.identifier[j].id;           var match = ark.split(\"/\");           docUrl = 'http://bionames.org/bionames-gallica/documentcloud/' + match[1] + match[2] + '.json';           break;                case \"biostor\":           docUrl = 'http://biostor.org/dv/' + doc.identifier[j].id + '.json';           break;                                      default:           break;       }     }   }                  if (docUrl == '')   {     if (doc.file)     {       if (doc.file.sha1)       {         docUrl = 'http://bionames.org/bionames-archive/documentcloud/' + doc.file.sha1 + '.json';       }     }     }    if (docUrl != '')   {     html += 'docUrl = \\'' + docUrl + '\\';';     html += 'display_document();';   }  html += ''; html += '</script>'; html += ''; html += '</body>'; html += '</html>';} else { switch (doc.type) { case 'nameCluster':  var title = doc.nameComplete;              if (doc.taxonAuthor) {   title += ' ' + doc.taxonAuthor; }  html += '<!DOCTYPE html>'; html += '<html>'; html += '<head>'; html += '  <base href=\"http://bionames.org/\" /><!--[if IE]></base><![endif]-->'; html += '  <title>' + title + '</title>'; html += '  '; html += '  <!-- standard stuff -->'; html += '  <meta charset=\"utf-8\" />'; html += '  <link href=\\'images/favicon.png\\' rel=\\'icon\\' type=\\'image/png\\'>'; html += '  '; html += '  <link href=\\'http://fonts.googleapis.com/css?family=Montserrat:400,700\\' rel=\\'stylesheet\\' type=\\'text/css\\'>'; html += '  '; html += '  <link href=\"vendor/bootstrap/css/bootstrap.min.css\" rel=\"stylesheet\" media=\"screen\">'; html += '  '; html += '  <!-- responsive -->'; html += '  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">'; html += '  <link href=\"vendor/bootstrap/css/bootstrap-responsive.css\" rel=\"stylesheet\">  '; html += '  '; html += '  <link href=\"stylesheets/style.css\" rel=\"stylesheet\" media=\"screen\">  <script src=\"http://code.jquery.com/jquery-1.9.1.min.js\"></script>'; html += '  <script src=\"vendor/bootstrap/js/bootstrap.min.js\"></script>'; html += '  <script src=\"js/lib/d3.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"js/lib/crossfilter.1.2.0.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  '; html += '  <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->'; html += '  <!--[if lt IE 9]>'; html += '    <script src=\"http://html5shim.googlecode.com/svn/trunk/html5.js\"></script>'; html += '  <![endif]-->'; html += ''; html += '  <script src=\"js/openurl.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"js/display.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"js/snippet.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += '  <script src=\"js/filter_widgets.js\" type=\"text/javascript\" charset=\"utf-8\"></script>'; html += ''; html += '  <!-- UserVoice JavaScript SDK (only needed once on a page) -->'; html += '  <script>(function(){var uv=document.createElement(\\'script\\');uv.type=\\'text/javascript\\';uv.async=true;uv.src=\\'//widget.uservoice.com/c3F4NBjddqKXajc7buiKtQ.js\\';var s=document.getElementsByTagName(\\'script\\')[0];s.parentNode.insertBefore(uv,s)})()</script>'; html += ''; html += '  <!-- A tab to launch the Classic Widget -->'; html += '  <script>'; html += '  UserVoice = window.UserVoice || [];'; html += '  UserVoice.push([\\'showTab\\', \\'classic_widget\\', {'; html += '    mode: \\'feedback\\','; html += '    primary_color: \\'#cc6d00\\','; html += '    link_color: \\'#007dbf\\','; html += '    forum_id: 208867,'; html += '    tab_label: \\'Feedback\\','; html += '    tab_color: \\'#cc6d00\\','; html += '    tab_position: \\'middle-right\\','; html += '    tab_inverted: false'; html += '  }]);'; html += '  </script>  '; html += '  <script>  '; html += '  '; html += '    function add_metadata_stat(title,value) {'; html += '      $(display_stat(title,value)).appendTo($(\\'#stats\\'));    '; html += '    }  '; html += '  </script>'; html += '</head>'; html += '<body class=\"name\">'; html += '  <script type=\"text/javascript\">'; html += '    var _gaq = _gaq || [];'; html += '    _gaq.push([\\'_setAccount\\', \\'UA-41311788-1\\']);'; html += '    _gaq.push([\\'_trackPageview\\']);'; html += '  '; html += '    (function() {'; html += '    var ga = document.createElement(\\'script\\'); ga.type = \\'text/javascript\\'; ga.async = true;'; html += '    ga.src = (\\'https:\\' == document.location.protocol ? \\'https://ssl\\' : \\'http://www\\') + \\'.google-analytics.com/ga.js\\';'; html += '    var s = document.getElementsByTagName(\\'script\\')[0]; s.parentNode.insertBefore(ga, s);'; html += '    })();'; html += '  </script>  '; html += ''; html += '  <div class=\"navbar navbar-fixed-top\">'; html += '  <div class=\"navbar-inner\">'; html += '    <div class=\"container-fluid\">'; html += '       <a class=\"brand\" href=\"/\">BioNames</a>'; html += '       <ul class=\"nav\">'; html += '        <li><form class=\"navbar-search pull-left\" method=\"get\" action=\"/\">'; html += '        <input type=\"text\" id=\\'q\\' name=\\'q\\' data-provide=\"typeahead\" class=\"search-query\" placeholder=\"Search\" autocomplete=\"off\" value=\"\">'; html += '        </form> '; html += '        </li>'; html += '        <li><a href=\"dashboard\">Dashboard</a></li>'; html += '        </ul>'; html += '      </div>'; html += '  </div>'; html += '</div>'; html += ''; html += '  <div itemscope itemtype=\"http://schema.org/Thing\" class=\"container-fluid\">'; html += '    <div class=\"row-fluid\">'; html += '      <div class=\"main-content span8\">'; html += '      <ul id=\"names-tabs\" class=\"nav nav-tabs\">'; html += '        <li class=\"active\"><a href=\"#names-tab\" data-toggle=\"tab\">Names <span id=\"names-badge\" class=\"badge badge-info\"></span></a></li>'; html += '        <li class=\"bibliography\"><a href=\"#biblio-tab\" data-toggle=\"tab\">Bibliography <span id=\"bibliography-badge\" class=\"badge badge-info\"></span></a></li>'; html += '        <li><a href=\"#species-tab\" data-toggle=\"tab\">Species <span id=\"species-badge\" class=\"badge badge-info\"></span></a></li>'; html += '      </ul>'; html += '      '; html += '      <div class=\"tab-content\">'; html += '        <div class=\"tab-pane active\" id=\"names-tab\">'; html += '        <div id=\"names\">'; html += '          <h4>Name(s) in cluster</h4>'; html += '          <table class=\"table\">';          for (var i in doc.names) {   html += '<tr>';   html += '<td>';   html += doc.names[i].nameComplete;   if (doc.names[i].taxonAuthor) {     html += ' ' + doc.names[i].taxonAuthor;   }   html += '</td>';   html += '<td>';      if (doc.names[i].id.match(/urn:lsid:organismnames.com:name:/)) {     html += '<a href=\"http://www.organismnames.com/details.htm?lsid=' + doc.names[i].id.replace('urn:lsid:organismnames.com:name:', '') + '\" target=\"_new\" onClick=\"_gaq.push([\\'_trackEvent\\', \\'External\\', \\'lsid\\', \\'' + doc.names[i].id + '\\', 0]);\" rel=\"tooltip\" title=\"Life Science Identifier (LSID) for this taxon name\" class=\"tip\"><i class=\"icon-share\"></i> ' + doc.names[i].id + '</a>';   }               html += '</td>'; }      html += '          </table>'; html += '        </div>'; html += '        </div>'; html += '      '; html += '        <div class=\"tab-pane no-pad\" id=\"biblio-tab\">'; html += '            <div id=\"publication-timeline\" class=\"publication-timeline\">'; html += '          <div class=\"pub-timeline\">'; html += '            <div id=\"pubHistogram\" class=\"chart\"></div>'; html += '          </div>'; html += '                <div id=\"pubList\"></div>'; html += '            </div>'; html += '        </div>'; html += '        '; html += '        <div class=\"tab-pane\" id=\"species-tab\">'; html += '        <div id=\"species\">...</div>'; html += '        </div>'; html += '        '; html += '        '; html += '      </div>'; html += '      </div>'; html += '      <div class=\"sidebar span4\">'; html += '      <div class=\"sidebar-header\">'; html += '        <h1 id=\"title\">';    html += '<span itemprop=\"name\">';   html += title;   html += '</span>';            html += '        </h1>'; html += '      </div>'; html += '      <div id=\"metadata\" class=\"sidebar-metadata\">'; html += '        <div id=\"stats\" class=\"stats\"></div>'; html += '        <div id=\"cluster\"></div>'; html += '      </div>'; html += '        <div id=\"concepts\" class=\"sidebar-section\"></div>'; html += '        <div id=\"related\" class=\"sidebar-section\"></div>'; html += '        <div id=\"epithet\" class=\"sidebar-section\"></div>'; html += '        '; html += '      <div>'; html += '        <div id=\"disqus_thread\"></div>'; html += '          <script type=\"text/javascript\">'; html += '            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */'; html += '            var disqus_shortname = \\'bionames\\'; /* required: replace example with your forum shortname */'; html += '          '; html += '            /* * * DON\\'T EDIT BELOW THIS LINE * * */'; html += '            (function() {'; html += '              var dsq = document.createElement(\\'script\\'); dsq.type = \\'text/javascript\\'; dsq.async = true;'; html += '              dsq.src = \\'//\\' + disqus_shortname + \\'.disqus.com/embed.js\\';'; html += '              (document.getElementsByTagName(\\'head\\')[0] || document.getElementsByTagName(\\'body\\')[0]).appendChild(dsq);'; html += '            })();'; html += '          </script>'; html += '          <noscript>Please enable JavaScript to view the <a href=\"http://disqus.com/?ref_noscript\">comments powered by Disqus.</a></noscript>'; html += '          <a href=\"http://disqus.com\" class=\"dsq-brlink\">comments powered by <span class=\"logo-disqus\">Disqus</span></a>'; html += '        </div>'; html += '      </div>   '; html += '      </div>'; html += '    </div>'; html += '  </div>'; html += ''; html += '<script>';  html += 'var id = \"' + doc._id + '\";';  html += ''; html += '  /* tooltips */'; html += '  $(\\'.tip\\').tooltip();'; html += '  ';  html += 'add_metadata_stat(\\'Names\\', ' + doc.names.length + ');';   html += '$(\\'#names-badge\\').text(' + doc.names.length + ');';    html += ''; html += '  $(\\'#names-tabs li:eq(0) a\\').show();'; html += '  '; html += '  function show_concepts(id)'; html += '  {'; html += '    $(\"#concepts\").html(\"\");'; html += '    '; html += '    $.getJSON(\"api/name/id/\" + id + \"/concepts?callback=?\",'; html += '      function(data){'; html += '        if (data.status == 200)'; html += '        {              '; html += '          add_metadata_stat(\"Concepts\", data.concepts.length);'; html += '          '; html += '          if (data.concepts.length > 0) {'; html += '            var concepts = [];'; html += '            var html = \\'<h3>This name has been used for these taxa</h3>\\';'; html += '            for (var i in data.concepts) {'; html += '              html += \\'<div id=\"id\\' + data.concepts[i].concept.replace(\\'/\\', \\'_\\') + \\'\"></div>\\';'; html += '              concepts.push(data.concepts[i].concept);'; html += '            }'; html += '            $(\"#concepts\").html(html);'; html += '            '; html += '            for (var i in concepts) {'; html += '              display_snippets(concepts[i]);'; html += '            }'; html += '          }'; html += '        }'; html += '      });'; html += '  }'; html += '  '; html += '    function show_epithet(epithet)'; html += '    {'; html += '      $(\"#epithet\").html(\"\");'; html += '      '; html += '      $.getJSON(\"api/name/\" + encodeURIComponent(epithet) + \"/epithet?callback=?\",'; html += '        function(data){'; html += '          if (data.status == 200)'; html += '          {  '; html += '            if (data.names.length > 1) {          '; html += '              var html = \\'<h3>Names with same epithet</h3>\\';'; html += '              html += \\'<div>\\';'; html += '              for (var i in data.names)'; html += '              {'; html += '                var s = data.names[i];'; html += '                html += \\'<a href=\"search/\\' + encodeURIComponent(s) + \\'\">\\' + s + \\'</a>\\' + \\'<br />\\';'; html += '              }'; html += '              html += \\'</div>\\';'; html += '              var current_html = $(\"#epithet\").html();'; html += '              $(\"#epithet\").html(current_html + html);'; html += '            }'; html += '          }'; html += '        });'; html += '    }'; html += '    '; html += '    function show_related(name)'; html += '    {'; html += '      $(\"#related\").html(\"\");'; html += '      '; html += '      $.getJSON(\"api/name/\" + encodeURIComponent(name) + \"/related?callback=?\",'; html += '        function(data){'; html += '          if (data.status == 200)'; html += '          {  '; html += '            add_metadata_stat(\"Related Names\", data.related.length);'; html += '            '; html += '            if (data.related.length > 0) {          '; html += '              var html = \\'<h3>Related names</h3>\\';'; html += '              html += \\'<p class=\"muted\">Possible synonyms</p>\\';'; html += '              html += \\'<ul>\\';'; html += '              for (var i in data.related)'; html += '              {'; html += '                var s = data.related[i];'; html += '                html += \\'<li><a href=\"search/\\' + encodeURIComponent(s) + \\'\">\\' + s + \\'</a></li>\\';'; html += '              }'; html += '              html += \\'</ul>\\';'; html += '              var current_html = $(\"#related\").html();'; html += '              $(\"#related\").html(current_html + html);'; html += '            }'; html += '          }'; html += '        });'; html += '    }'; html += '  '; html += '  '; html += ''; html += '  /* typeahead for search box */'; html += '  $(\"#q\").typeahead({'; html += '    source: function (query, process) {'; html += '    $.getJSON(\\'http://bionames.org/bionames-api/name/\\' + query + \\'/suggestions?callback=?\\', '; html += '    function (data) {'; html += '      var suggestions = data.suggestions;'; html += '      process(suggestions)'; html += '    })'; html += '    }'; html += '  });'; html += '  '; html += '  show_concepts(id);'; html += '</script>'; html += '</body>'; html += '</html>'; break; default: break; } } return html; }"
   }
}